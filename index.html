<!DOCTYPE html>
<html>
  <head>
    <title>Quest 2 Native AR Test</title>
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <style>
      /* Basic styling for our status message and AR entry button */
      body { margin: 0; overflow: hidden; }
      #status {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background-color: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 10px 20px;
        border-radius: 5px;
        font-family: sans-serif;
        font-size: 16px;
        z-index: 10;
      }
    </style>
  </head>
  <body>
    <a-scene
      vr-mode-ui="enabled: false"
      ar-mode-ui="enabled: true"
      webxr="requiredFeatures: ['hit-test', 'dom-overlay']; optionalFeatures: ['plane-detection', 'depth-sensing']"
      renderer="alpha: true"
    >
      <a-camera position="0 1.6 0"></a-camera>

      <a-plane
        position="0 0 0"
        rotation="-90 0 0"
        width="10"
        height="10"
        color="#00FF00"
        opacity="0.7"
      ></a-plane>

      <a-box
        position="0 1 -3"
        rotation="0 45 0"
        color="#FF0000"
        depth="0.5"
        height="0.5"
        width="0.5"
      ></a-box>

      <div id="dom-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 1;"></div>
    </a-scene>

    <div id="status">Checking WebXR AR support...</div>

    <script>
      // JavaScript to update the status message
      const statusDiv = document.getElementById('status');
      const scene = document.querySelector('a-scene');

      scene.addEventListener('enter-vr', function () {
        if (scene.is('ar-mode')) {
          statusDiv.textContent = 'Entered AR Mode!';
        } else {
          statusDiv.textContent = 'Entered VR Mode (AR not available/selected).';
        }
      });

      scene.addEventListener('exit-vr', function () {
        statusDiv.textContent = 'Exited Immersive Mode.';
      });

      // Check for AR session support on page load
      if (navigator.xr) {
        navigator.xr.isSessionSupported('immersive-ar').then((supported) => {
          if (supported) {
            statusDiv.textContent = 'WebXR AR supported! Click ENTER AR.';
          } else {
            statusDiv.textContent = 'WebXR AR not supported on this device/browser.';
          }
        }).catch(e => {
          statusDiv.textContent = `Error checking AR support: ${e.message}`;
          console.error("Error checking AR session support:", e);
        });
      } else {
        statusDiv.textContent = 'WebXR API not found in this browser.';
      }
    </script>
  </body>
</html>
