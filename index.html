<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tetris - Game Boy Retro</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Orbitron font for retro LCD look -->
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(135deg, #8b956d, #c4cfa1);
      min-height: 100vh; margin: 0; display: flex; align-items: center; justify-content: center;
      font-family: 'Orbitron', monospace;
    }
    .gameboy {
      background: #aab674;
      border-radius: 24px;
      box-shadow: 8px 8px 24px #3a4220, inset 0 8px 28px #fff8;
      padding: 36px 32px 32px 32px;
      width: 430px;
      border: 4px solid #545b2f;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .screen-container {
      background: #323825;
      border-radius: 14px;
      padding: 18px;
      margin-bottom: 18px;
      width: 100%;
      box-shadow: inset 2px 2px 12px #0009;
      display: flex; flex-direction: row;
    }
    .game-area {
      background: #7b9b3a;
      border-radius: 8px;
      box-shadow: inset 1px 2px 7px #404819;
      width: 212px;
      height: 426px;
      position: relative;
      display: flex;
      justify-content: center;
      align-items: flex-end;
      margin-right: 18px;
    }
    .game-board {
      display: grid;
      grid-template-columns: repeat(10, 20px);
      grid-template-rows: repeat(20, 20px);
      gap: 1px;
      width: 202px; height: 402px;
      background: #b8c27a;
      border: 2px solid #555c2f;
    }
    .cell { width: 20px; height: 20px; background: #b2ba7e; }
    .cell.filled { background: #4d6526; }
    .cell.active { background: #30531c; }
    .side-panel {
      flex: 1; display: flex; flex-direction: column; gap: 14px;
    }
    .info-box {
      background: #b2ba7e;
      border: 2px solid #6b7353;
      border-radius: 7px;
      padding: 9px 0 7px 0;
      text-align: center;
      font-size: 14px;
      box-shadow: inset 1px 1px 3px #fff3;
    }
    .next-piece {
      display: grid;
      grid-template-columns: repeat(4, 14px);
      grid-template-rows: repeat(4, 14px);
      gap: 1px;
      margin: 5px auto;
      justify-content: center;
    }
    .next-cell { width: 14px; height: 14px; background: #b2ba7e; }
    .next-cell.filled { background: #4d6526; }
    .controls {
      font-size: 11px; color: #334216; margin-top: 13px; text-align: center;
      letter-spacing: 1px;
    }
    .game-over {
      position: absolute; top: 42%; left: 50%; transform: translate(-50%, -50%);
      background: rgba(30,33,36,0.94); color: #b8c27a;
      border-radius: 10px; text-align: center;
      font-size: 23px; padding: 20px 40px; z-index: 3;
      border: 2px solid #6b7353; box-shadow: 0 0 6px #223;
      display: none;
    }
    button {
      margin-top: 8px; font-family: inherit; font-size: 15px;
      background: #6b7353; color: #f6fbe9; border: none; border-radius: 6px;
      padding: 7px 20px; cursor: pointer; font-weight: 700; box-shadow: 2px 2px 4px #5556;
    }
    button:active { background: #4d6526; }
    @media (max-width: 520px) {
      .gameboy { width: 98vw; padding: 4vw; }
      .screen-container { flex-direction: column; }
      .side-panel { flex-direction: row; gap: 10px; }
    }
  </style>
</head>
<body>
  <div class="gameboy">
    <div class="screen-container">
      <div class="game-area">
        <div class="game-board" id="gameBoard"></div>
        <div class="game-over" id="gameOver">
          <div>GAME OVER</div>
          <div style="font-size:15px; margin-top:10px;">Press Enter/Space or Tap</div>
          <button onclick="resetGame()">Restart</button>
        </div>
      </div>
      <div class="side-panel">
        <div class="info-box">
          <div>SCORE</div>
          <div id="score" style="font-size:22px;">0</div>
        </div>
        <div class="info-box">
          <div>LINES</div>
          <div id="lines" style="font-size:19px;">0</div>
        </div>
        <div class="info-box">
          <div>NEXT</div>
          <div class="next-piece" id="nextPiece"></div>
        </div>
      </div>
    </div>
    <div class="controls">
      ⬅️➡️ Move &nbsp; ⬆️ Rotate &nbsp; ⬇️ Drop <br>
      Space/Enter = Start/Hard Drop<br>
      Touch or Click board = play!
    </div>
  </div>
  <script>
    // ---- Tetris Logic ----
    const BOARD_W=10, BOARD_H=20, COLORS=['','#4d6526'], SHAPES=[
      [[1,1,1,1]], [[1,1],[1,1]], [[0,1,0],[1,1,1]], [[1,1,0],[0,1,1]], [[0,1,1],[1,1,0]], [[1,0,0],[1,1,1]], [[0,0,1],[1,1,1]]
    ];
    let board, falling, fx, fy, frot, next, score=0, lines=0, run=false, over=false, dropTimer, fallRate=500;
    const boardDiv = document.getElementById('gameBoard'), overDiv = document.getElementById('gameOver');
    // DOM cell cache
    let cellDivs = [];

    function resetGame() {
      board = Array.from({length:BOARD_H},()=>Array(BOARD_W).fill(0));
      falling=randShape(); fx=3; fy=0; frot=0; next=randShape(); score=0; lines=0; fallRate=500; run=true; over=false;
      overDiv.style.display="none"; update(); loop();
    }
    function randShape() {
      const i = Math.floor(Math.random()*SHAPES.length);
      return {shape: SHAPES[i], id:1, type:i};
    }
    function rotate(shape) {
      return shape[0].map((_,i)=>shape.map(r=>r[i]).reverse());
    }
    function canMove(s,x,y,rot) {
      const sh = rot?rotate(s.shape):s.shape;
      for (let r=0;r<sh.length;r++)
        for(let c=0;c<sh[r].length;c++)
          if(sh[r][c]&&(y+r<0||x+c<0||x+c>=BOARD_W||y+r>=BOARD_H||board[y+r][x+c]))return false;
      return true;
    }
    function fix() {
      let sh = frot?rotate(falling):falling.shape;
      for(let r=0;r<sh.length;r++)
        for(let c=0;c<sh[r].length;c++)
          if(sh[r][c]&&fy+r>=0)board[fy+r][fx+c]=falling.id;
      clear();
      falling=next; next=randShape(); fx=3; fy=0; frot=0;
      if(!canMove(falling,fx,fy,frot)){run=false;over=true;overDiv.style.display="block";}
    }
    function clear() {
      for(let r=BOARD_H-1;r>=0;r--) {
        if(board[r].every(v=>v)){board.splice(r,1);board.unshift(Array(BOARD_W).fill(0));score+=100;lines++;}
      }
      fallRate=Math.max(80,500-~~(lines/5)*35);
    }
    function loop() {
      if(!run)return;
      if(canMove(falling,fx,fy+1,frot)){fy++;}
      else{fix();}
      update();
      dropTimer=setTimeout(loop,fallRate);
    }
    function hardDrop(){
      while(canMove(falling,fx,fy+1,frot))fy++;
      fix();update();
    }
    function move(dx){
      if(canMove(falling,fx+dx,fy,frot)){fx+=dx;update();}
    }
    function rotateF(){
      if(canMove(falling,fx,fy,(frot+1)%4)){frot=(frot+1)%4;update();}
    }
    function softDrop(){
      if(canMove(falling,fx,fy+1,frot)){fy++;update();}
    }
    function update(){
      // Render board
      if (!cellDivs.length) {
        boardDiv.innerHTML = '';
        for(let r=0;r<BOARD_H;r++)for(let c=0;c<BOARD_W;c++){
          let d=document.createElement('div');d.className='cell';boardDiv.appendChild(d);cellDivs.push(d);
        }
      }
      // Draw board
      for(let r=0;r<BOARD_H;r++)for(let c=0;c<BOARD_W;c++)
        cellDivs[r*BOARD_W+c].className='cell'+(board[r][c]?' filled':'');
      // Draw falling
      let sh = frot?rotate(falling):falling.shape;
      for(let r=0;r<sh.length;r++)
        for(let c=0;c<sh[r].length;c++)
          if(sh[r][c]&&fy+r>=0&&fy+r<BOARD_H&&fx+c>=0&&fx+c<BOARD_W)
            cellDivs[(fy+r)*BOARD_W+fx+c].className='cell active';
      // Score/lines
      document.getElementById('score').textContent=score;
      document.getElementById('lines').textContent=lines;
      // Next piece
      let nextBox=document.getElementById('nextPiece');nextBox.innerHTML='';
      for(let r=0;r<4;r++)for(let c=0;c<4;c++){
        let d=document.createElement('div');d.className='next-cell';
        if(next.shape[r]&&next.shape[r][c])d.classList.add('filled');
        nextBox.appendChild(d);
      }
    }
    // Keyboard/touch
    window.addEventListener('keydown',e=>{
      if(over&&(e.key===' '||e.key==='Enter')){resetGame();return;}
      if(!run)return;
      if(e.key==='ArrowLeft')move(-1);
      if(e.key==='ArrowRight')move(1);
      if(e.key==='ArrowDown')softDrop();
      if(e.key==='ArrowUp')rotateF();
      if(e.key===' '||e.key==='Enter')hardDrop();
    });
    boardDiv.addEventListener('click',()=>{ if(over){resetGame();return;} hardDrop(); });
    // Init
    resetGame();
  </script>
</body>
</html>
