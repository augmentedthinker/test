<!DOCTYPE html>
<html>
  <head>
    <title>VR Arcade Room â€“ Full Controls</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <!-- Movement controls via aframe-extras (controller support, smooth locomotion) -->
    <script src="https://cdn.jsdelivr.net/npm/aframe-extras@7.0.0/dist/aframe-extras.controls.min.js"></script>
  </head>
  <body>
    <a-scene background="color: #333344" shadow="type: pcfsoft">
      <!-- Room (large cube) -->
      <a-box position="0 5 0" width="15" height="10" depth="15" color="#222" side="double" material="opacity:0.93"></a-box>

      <!-- Arcade Cabinet -->
      <a-box id="arcade" position="0 2 -4" width="2" height="4" depth="0.5" color="#775555" shadow="cast: true"></a-box>

      <!-- Color Tiles (on the front face of the arcade) -->
      <a-box class="color-tile" color="#e74c3c" position="-0.7 3.2 -3.7" width="0.6" height="0.6" depth="0.1"></a-box>
      <a-box class="color-tile" color="#3498db" position="0 3.2 -3.7" width="0.6" height="0.6" depth="0.1"></a-box>
      <a-box class="color-tile" color="#2ecc71" position="0.7 3.2 -3.7" width="0.6" height="0.6" depth="0.1"></a-box>
      <a-box class="color-tile" color="#f1c40f" position="-0.7 2.5 -3.7" width="0.6" height="0.6" depth="0.1"></a-box>
      <a-box class="color-tile" color="#9b59b6" position="0 2.5 -3.7" width="0.6" height="0.6" depth="0.1"></a-box>
      <a-box class="color-tile" color="#ffffff" position="0.7 2.5 -3.7" width="0.6" height="0.6" depth="0.1"></a-box>

      <!-- Camera Rig with WASD and VR controller movement -->
      <a-entity id="rig" movement-controls="fly: false; speed: 0.08" position="0 0 8">
        <a-entity
          id="camera"
          camera
          wasd-controls
          look-controls="pointerLockEnabled: false"
          position="0 1.6 0">
        </a-entity>
        <!-- Left hand controller (laser + click) -->
        <a-entity
          id="left-hand"
          laser-controls="hand: left"
          raycaster="objects: .color-tile"
          line="color: blue; opacity: 0.8">
        </a-entity>
        <!-- Right hand controller (laser + click) -->
        <a-entity
          id="right-hand"
          laser-controls="hand: right"
          raycaster="objects: .color-tile"
          line="color: red; opacity: 0.8">
        </a-entity>
      </a-entity>

      <!-- Desktop cursor (optional for quick browser testing) -->
      <a-entity cursor="rayOrigin: mouse"></a-entity>

      <script>
        // Color-changer for tiles
        AFRAME.registerComponent('color-changer', {
          init: function () {
            this.el.addEventListener('click', function () {
              var color = this.getAttribute('color');
              // Find the big room box and change its color
              document.querySelector('a-box').setAttribute('color', color);
            });
          }
        });
        // Attach color-changer to all color tiles
        window.addEventListener('DOMContentLoaded', function () {
          document.querySelectorAll('.color-tile').forEach(tile => {
            tile.setAttribute('color-changer', '');
          });
        });
      </script>
    </a-scene>
  </body>
</html>
