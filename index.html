<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Advanced Interactive VR</title>
  <script src="https://aframe.io/releases/1.7.1/aframe.min.js"></script>
  <script src="https://unpkg.com/aframe-teleport-controls@latest/dist/aframe-teleport-controls.min.js"></script>
  <script src="https://unpkg.com/aframe-super-hands@^3.0.0/dist/aframe-super-hands.min.js"></script>
  <script src="https://unpkg.com/aframe-haptics-component/dist/aframe-haptics-component.min.js"></script>
</head>
<body style="margin:0; height:100vh;">

<a-scene>

  <a-entity hand-controls="hand: left"
            teleport-controls="cameraRig: #rig; button: trigger; collisionEntities: .floor"
            haptics="events: grab-start, triggerdown">
  </a-entity>
  <a-entity hand-controls="hand: right"
            teleport-controls="cameraRig: #rig; button: trigger; collisionEntities: .floor"
            haptics="events: grab-start, triggerdown">
  </a-entity>

  <a-entity id="rig" position="0 1.6 0">
    <a-entity camera look-controls>
      <a-entity cursor="rayOrigin: mouse; fuse: true; fuseTimeout: 1500"
                raycaster="objects: .interactive"></a-entity>
    </a-entity>
  </a-entity>

  <a-plane class="floor" position="0 0 0" rotation="-90 0 0"
           width="10" height="10" color="#7BC8A4"></a-plane>

  <a-box class="interactive grabbable"
         position="-1 0.5 -3"
         color="#4CC3D9"
         event-set__enter="_event: mouseenter; scale: 1.3 1.3 1.3"
         event-set__leave="_event: mouseleave; scale: 1 1 1"
         tooltip="text: I am a box; color: black; background: white; width: auto">
  </a-box>

  <a-sphere class="interactive grabbable"
            position="1 1.25 -4"
            radius="1.25"
            color="#EF2D5E"
            animation="property: position; to: 1 2.25 -4; dir: alternate; dur: 2000; loop: true"
            tooltip="text: Grab me and move me!">
  </a-sphere>

  <a-cylinder position="0 0.75 -2" radius="0.5" height="1.5" color="#FFC65D"></a-cylinder>

  <a-sky color="#ECECEC"></a-sky>

</a-scene>

<script>
  // Simple tooltip component
  AFRAME.registerComponent('tooltip', {
    schema: { text: {type: 'string'}, color: {type:'string', default:'#000'}, background:{type:'string', default:'#fff'} },
    init: function () {
      const el = this.el;
      const data = this.data;
      const label = document.createElement('a-text');
      label.setAttribute('value', data.text);
      label.setAttribute('color', data.color);
      label.setAttribute('position', '0 0.75 0');
      label.setAttribute('scale', '2 2 2');
      const bg = document.createElement('a-plane');
      bg.setAttribute('color', data.background);
      bg.setAttribute('width', data.text.length / 5 + 0.5);
      bg.setAttribute('height', 0.3);
      bg.setAttribute('position', '0 0.75 -0.01');
      bg.setAttribute('visible', 'false');
      label.setAttribute('visible', 'false');
      el.appendChild(bg);
      el.appendChild(label);
      el.addEventListener('mouseenter', () => { bg.setAttribute('visible', true); label.setAttribute('visible', true); });
      el.addEventListener('mouseleave', () => { bg.setAttribute('visible', false); label.setAttribute('visible', false); });
    }
  });
</script>

</body>
</html>
