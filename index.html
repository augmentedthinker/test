<html>
  <head>
    <title>VR Scene - Day/Night Cycle (Meta Quest)</title>
    <!-- Core and community A-Frame scripts -->
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@1.5.3/dist/aframe-environment-component.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/aframe-extras@7.0.0/dist/aframe-extras.min.js"></script>
    <script src="https://unpkg.com/aframe-teleport-controls@0.6.3/dist/aframe-teleport-controls.min.js"></script>
    <script>
      // Custom component for day/night sun animation
      AFRAME.registerComponent('day-night-cycle', {
        schema: {
          duration: {type: 'number', default: 120}, // in seconds
          intensity: {type: 'number', default: 0.8} // arc height
        },
        init: function () {
          this.env = document.getElementById('env');
          this.startTime = null;
        },
        tick: function (time, timeDelta) {
          if (!this.startTime) this.startTime = time;
          var elapsed = ((time - this.startTime) / 1000) % this.data.duration;
          var t = elapsed / this.data.duration; // 0 to 1
          // Sun moves in a half-circle: noon (y=+intensity) to midnight (y=-intensity)
          var angle = t * Math.PI; // 0 to PI
          var sunY = Math.cos(angle) * this.data.intensity;
          var sunZ = -Math.sin(angle) * this.data.intensity;
          this.env.setAttribute('environment', 'lightPosition', `0 ${sunY} ${sunZ}`);
        }
      });
    </script>
  </head>
  <body>
    <a-scene background="color: #88ccee">
      <!-- Environment entity with day/night animation -->
      <a-entity id="env"
        environment="preset: forest; shadow: true; fog: 0.1; groundColor: #6B8E23; groundColor2: #228B22"
        day-night-cycle="duration: 120; intensity: 0.8">
      </a-entity>
      
      <!-- Camera rig, locomotion, controllers, lasers, teleport -->
      <a-entity id="cameraRig" movement-controls position="0 1.6 0">
        <a-entity camera look-controls wasd-controls position="0 0 0"></a-entity>
        <!-- Left Controller: model, laser, teleport -->
        <a-entity id="leftHand"
                  meta-touch-controls="hand: left"
                  laser-controls="hand: left"
                  raycaster="objects: .interactable; showLine: true; far: 10"
                  line="color: #ff6699; opacity: 0.8"
                  teleport-controls="button: trigger; cameraRig: #cameraRig; collisionEntities: #ground; curveShootingSpeed: 12">
        </a-entity>
        <!-- Right Controller: model, laser -->
        <a-entity id="rightHand"
                  meta-touch-controls="hand: right"
                  laser-controls="hand: right"
                  raycaster="objects: .interactable; showLine: true; far: 10"
                  line="color: #6699ff; opacity: 0.8">
        </a-entity>
      </a-entity>

      <!-- Ground (teleportable, interactable) -->
      <a-plane id="ground" color="#7BC8A4" rotation="-90 0 0" width="20" height="20" class="interactable"></a-plane>
      <!-- Demo box to point lasers at (optional, remove if you want) -->
      <a-box position="0 1 -3" color="#F16745" class="interactable"></a-box>
    </a-scene>
  </body>
</html>
